# 更新日志

## v0.1.4

### 核心系统重构 (Major Refactoring)
- **节点注册系统标准化**: 
  - 全面引入 `NodeHelper` 链式调用 API，规范了所有节点的元数据声明与逻辑注册流程。

### 蓝图格式升级
- **蓝图格式版本 (Format 3)**: 提升了蓝图存储格式版本，以兼容重构后的节点注册逻辑及未来更复杂的属性扩展。

## v0.1.3

### 列表系统彻底重构
- **移除伪列表逻辑 (Legacy List Cleanup)**: 
  - 彻底删除了所有基于 `|` 符号拼接的“字符串列表”逻辑。
  - `TypeConverter` 转换引擎现在完全拥抱原生 Java `List` 与 Gson `JsonArray`。
  - `String Split` (字符串分割) 与 `On MgRun` (事件参数) 节点现在直接输出真实的列表对象。

## v0.1.2

### 核心引擎重构
- **彻底去字符串化 (De-stringification)**: 
  - 重构了节点输入输出系统，核心计算流程（数学、逻辑、列表、变量）现在直接使用原生 Java 类型（Double, Boolean, List）进行流转。
  - 显著降低了在高频触发场景下的内存抖动与 CPU 转换开销。
- **蓝图格式版本化 (Format Versioning)**: 
  - 引入 `format_version: 2` 格式，支持原生 JSON 类型存储。
  - 完美向下兼容旧版蓝图，确保老脚本无需修改即可运行。

### 安全与稳定性增强
- **服务端权限校验**: 
  - 增加了对蓝图保存、删除、重命名等敏感操作的服务端 OP 权限（Level 2）校验。
  - 修复了客户端可以绕过编辑器限制直接操作服务端文件的安全漏洞。
- **路径穿越防护**: 对蓝图文件名进行了严格的正则校验，严禁 `..` 或路径分隔符，防止非法文件操作。
- **死循环保护机制**: 
  - 引入了 `max_node_executions` 配置项，限制单个事件触发下的最大节点执行数。
  - 即使编写了逻辑错误的无限循环，也不会导致服务器卡死或崩溃。
- **异步 IO 处理**: 蓝图保存操作现在完全异步化，避免了在大规模蓝图保存时造成的瞬时卡顿。

### 节点优化
- **变量系统**: `Get/Set Variable` 现在支持存储任何类型的对象，不再强制转换为字符串。
- **列表包含节点**: 优化了匹配逻辑，现在支持对数值、布尔值及字符串的智能匹配。

## v0.1.1

### 新特性
- **多人联机支持**: 实现了完整的客户端-服务端同步协议，支持在多人服务器中使用蓝图系统。
- **服务端统一存储**: 联机模式下蓝图现在统一存储在服务端存档目录（`world/mgmc_blueprints`），确保所有玩家同步。
- **版本校验系统**: 引入蓝图版本号机制，防止多人同时编辑同一蓝图时发生竞态冲突导致数据损坏。
